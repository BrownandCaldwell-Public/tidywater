<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Determine if TOC removal meets Stage 1 DBP Rule requirements — regulate_toc • tidywater</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Determine if TOC removal meets Stage 1 DBP Rule requirements — regulate_toc"><meta name="description" content="This function takes raw water alkalinity, raw water TOC, and finished water TOC.
It then calculates the TOC removal percentage and checks compliance with the Stage 1 DBP Rule."><meta property="og:description" content="This function takes raw water alkalinity, raw water TOC, and finished water TOC.
It then calculates the TOC removal percentage and checks compliance with the Stage 1 DBP Rule."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tidywater</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.10.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/tidywater.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/coeff_fitting_chemdose_dbp.html">Fitting and using custom coefficients in chemdose_dbp</a></li>
    <li><a class="dropdown-item" href="../articles/help_functions_blend_waters.html">Blending Multiple Waters</a></li>
    <li><a class="dropdown-item" href="../articles/help_functions_chemdose_ph.html">Helper Functions &amp; Dose Chemicals</a></li>
    <li><a class="dropdown-item" href="../articles/intro.html">Introduction to tidywater: Basic functions</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/BrownandCaldwell-Public/tidywater/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Determine if TOC removal meets Stage 1 DBP Rule requirements</h1>
      <small class="dont-index">Source: <a href="https://github.com/BrownandCaldwell-Public/tidywater/blob/main/R/regulate_toc.R" class="external-link"><code>R/regulate_toc.R</code></a></small>
      <div class="d-none name"><code>regulate_toc.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function takes raw water alkalinity, raw water TOC, and finished water TOC.
It then calculates the TOC removal percentage and checks compliance with the Stage 1 DBP Rule.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">regulate_toc</span><span class="op">(</span><span class="va">alk_raw</span>, <span class="va">toc_raw</span>, <span class="va">toc_finished</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">regulate_toc_df</span><span class="op">(</span></span>
<span>  <span class="va">df</span>,</span>
<span>  alk_raw <span class="op">=</span> <span class="st">"use_col"</span>,</span>
<span>  toc_raw <span class="op">=</span> <span class="st">"use_col"</span>,</span>
<span>  toc_finished <span class="op">=</span> <span class="st">"use_col"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-alk-raw">alk_raw<a class="anchor" aria-label="anchor" href="#arg-alk-raw"></a></dt>
<dd><p>Raw water alkalinity (mg/L as calcium carbonate).</p></dd>


<dt id="arg-toc-raw">toc_raw<a class="anchor" aria-label="anchor" href="#arg-toc-raw"></a></dt>
<dd><p>Raw water total organic carbon (mg/L).</p></dd>


<dt id="arg-toc-finished">toc_finished<a class="anchor" aria-label="anchor" href="#arg-toc-finished"></a></dt>
<dd><p>Finished water total organic carbon (mg/L).</p></dd>


<dt id="arg-df">df<a class="anchor" aria-label="anchor" href="#arg-df"></a></dt>
<dd><p>a data frame optionally containing columns for raw water alkalinity, raw water TOC, and finished water TOC</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame containing the TOC removal compliance status.</p>
<p>A data frame with compliance status, removal percent, and optional note columns.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function prints the input parameters and the calculated removal
percentage for TOC. It checks compliance with regulations considering the raw
TOC, alkalinity, and removal percentage. If the conditions are met, it prints
"In compliance"; otherwise, it prints "Not in compliance" and stops execution
with an error message.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">regulate_toc</span><span class="op">(</span><span class="fl">50</span>, <span class="fl">5</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   toc_compliance_status toc_removal_percent</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         In Compliance                  60</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">regulated</span> <span class="op">&lt;-</span> <span class="va">water_df</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span>toc_raw <span class="op">=</span> <span class="va">toc</span>, alk_raw <span class="op">=</span> <span class="va">alk</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">regulate_toc_df</span><span class="op">(</span>toc_finished <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1.2</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">regulated</span> <span class="op">&lt;-</span> <span class="va">water_df</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="define_water_df.html">define_water_df</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="chemdose_ph.html">chemdose_ph_df</a></span><span class="op">(</span>alum <span class="op">=</span> <span class="fl">30</span>, output_water <span class="op">=</span> <span class="st">"dosed"</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="chemdose_toc.html">chemdose_toc_df</a></span><span class="op">(</span><span class="st">"dosed"</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="pluck_water.html">pluck_water</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"coagulated"</span>, <span class="st">"defined"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"toc"</span>, <span class="st">"alk"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span>toc_finished <span class="op">=</span> <span class="va">coagulated_toc</span>, toc_raw <span class="op">=</span> <span class="va">defined_toc</span>, alk_raw <span class="op">=</span> <span class="va">defined_alk</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">regulate_toc_df</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Raw water TOC &lt; 2 mg/L. No regulation applies.</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sierra Johnson, Libby McKenna, Riley Mulhern, Chris Corwin, Brown and Caldwell.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

